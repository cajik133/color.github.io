<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Тест Люшера</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    #color-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    .color-btn {
      width: 80px;
      height: 80px;
      border: none;
      cursor: pointer;
    }
    #submit-btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      background: green;
      color: white;
      border: none;
      cursor: pointer;
      display: none;
    }
    #message {
      margin-top: 20px;
      font-size: 18px;
      color: green;
      display: none;
    }
  </style>
</head>
<body>

  <h2>Выбери цвета в порядке предпочтения</h2>
  <div id="color-grid"></div>
  <button id="submit-btn" onclick="sendResult()">Отправить</button>
  <p id="message">Результаты получены, возвращайся в бот!</p>

  <script>
    const colors = [
      { name: "Синий", hex: "#0000FF" },
      { name: "Зеленый", hex: "#008000" },
      { name: "Красный", hex: "#FF0000" },
      { name: "Желтый", hex: "#FFFF00" },
      { name: "Фиолетовый", hex: "#800080" },
      { name: "Коричневый", hex: "#A52A2A" },
      { name: "Черный", hex: "#000000" },
      { name: "Серый", hex: "#808080" }
    ];

    const selectedOrder = [];
    const colorGrid = document.getElementById("color-grid");
    const submitBtn = document.getElementById("submit-btn");
    const message = document.getElementById("message");

    function renderColors() {
      colorGrid.innerHTML = "";
      colors.forEach((color, index) => {
        if (!selectedOrder.includes(index)) {
          const btn = document.createElement("button");
          btn.className = "color-btn";
          btn.style.background = color.hex;
          btn.onclick = () => chooseColor(index);
          colorGrid.appendChild(btn);
        }
      });
    }

    function chooseColor(index) {
      selectedOrder.push(index + 1); // +1 чтобы нумерация шла с 1
      renderColors();
      if (selectedOrder.length === colors.length) {
        submitBtn.style.display = "block";
      }
    }

    function sendResult() {
      const webhookUrl = "https://hook.eu2.make.com/qhbbx786kvg96gvpgru3kacap9elhtkf";
      const data = selectedOrder.join(","); // Отправляем в виде "3,1,7,5,6,2,8,4"

      fetch(webhookUrl, {
        method: "POST",
        headers: {
          "Content-Type": "text/plain"
        },
        body: data
      })
      .then(response => response.text())
      .then(() => {
        message.style.display = "block"; // Показываем сообщение
        submitBtn.style.display = "none"; // Убираем кнопку
      })
      .catch(error => console.error("Ошибка при отправке данных:", error));
    }

    renderColors();
  </script>

</body>
</html>
